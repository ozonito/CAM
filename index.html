<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quiz de Flashcards de Derecho</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
        }
        .card {
            background-color: #1f2937; /* bg-gray-800 */
            border-radius: 0.75rem; /* rounded-xl */
            padding: 2rem;
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
            transition: transform 0.3s ease;
        }
        .btn {
            display: block;
            width: 100%;
            padding: 1rem;
            border-radius: 0.5rem; /* rounded-lg */
            text-align: left;
            font-weight: 500;
            transition: all 0.2s ease-in-out;
            border: 1px solid #4b5563; /* border-gray-600 */
            background-color: #374151; /* bg-gray-700 */
        }
        .btn:hover {
            background-color: #4b5563; /* bg-gray-600 */
            transform: translateY(-2px);
        }
        .btn-correct {
            background-color: #10b981 !important; /* bg-emerald-500 */
            color: white;
            border-color: #059669 !important;
        }
        .btn-incorrect {
            background-color: #ef4444 !important; /* bg-red-500 */
            color: white;
            border-color: #dc2626 !important;
        }
        .feedback-popup {
            position: fixed;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            padding: 1rem 2rem;
            border-radius: 0.75rem;
            color: white;
            font-weight: 600;
            z-index: 50;
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.3s, visibility 0.3s;
            width: 90%;
            max-width: 600px;
            text-align: center;
        }
        .feedback-popup.show {
            opacity: 1;
            visibility: visible;
        }
        /* Ocultar las flechas del input num√©rico */
        input[type=number]::-webkit-inner-spin-button, 
        input[type=number]::-webkit-outer-spin-button { 
          -webkit-appearance: none; 
          margin: 0; 
        }
        input[type=number] {
          -moz-appearance: textfield;
        }
    </style>
</head>
<body class="bg-gray-900 text-gray-200 flex items-center justify-center min-h-screen p-4">

    <div id="app-container" class="w-full max-w-2xl mx-auto">
        <!-- Setup Screen -->
        <div id="setup-screen" class="card text-center">
            <h1 class="text-3xl font-bold mb-2 text-white">Quiz de Oposiciones</h1>
            <p class="text-gray-400 mb-6">Configura tu sesi√≥n de estudio</p>
            
            <div class="mb-4 text-left">
                <label for="topic" class="block mb-2 font-medium text-gray-300">Bloque Tem√°tico:</label>
                <select id="topic" class="w-full p-3 rounded-lg bg-gray-700 border border-gray-600 text-white focus:outline-none focus:ring-2 focus:ring-blue-500">
                    <option value="todo">TODO</option>
                    <option value="administrativo">Derecho Administrativo</option>
                    <option value="civil">Derecho Civil</option>
                    <option value="mercantil">Derecho Mercantil</option>
                </select>
            </div>

            <div class="mb-6 text-left">
                <label for="num-questions" class="block mb-2 font-medium text-gray-300">N√∫mero de Preguntas:</label>
                <input type="number" id="num-questions" value="10" min="1" class="w-full p-3 rounded-lg bg-gray-700 border border-gray-600 text-white focus:outline-none focus:ring-2 focus:ring-blue-500">
            </div>

            <button id="start-btn" class="w-full bg-blue-600 text-white font-bold py-3 px-4 rounded-lg hover:bg-blue-700 transition duration-300 text-lg">
                Comenzar
            </button>
        </div>

        <!-- Quiz Screen -->
        <div id="quiz-screen" class="hidden">
            <div class="flex justify-between items-center mb-4">
                <span id="progress" class="text-lg font-semibold text-gray-400"></span>
                <span id="score-display" class="text-lg font-semibold text-gray-400">‚úÖ 0 ‚ùå 0</span>
            </div>
            <div id="quiz-card" class="card">
                <p id="question" class="text-xl font-medium mb-6 leading-relaxed text-white"></p>
                <div id="options" class="space-y-3">
                    <!-- Options will be injected here -->
                </div>
            </div>
             <p id="motivational-phrase" class="text-center mt-4 text-gray-500 italic"></p>
        </div>

        <!-- Results Screen -->
        <div id="results-screen" class="hidden card text-center">
            <h2 class="text-3xl font-bold mb-4 text-white">Resultados Finales</h2>
            <div id="results-summary" class="text-xl mb-6"></div>
            <div id="review-section" class="text-left mb-6">
                <h3 class="text-2xl font-semibold mb-3 text-white">Conceptos a Repasar:</h3>
                <ul id="review-list" class="list-disc pl-5 space-y-3 text-gray-300">
                    <!-- Incorrect answers will be listed here -->
                </ul>
            </div>
             <p id="final-message" class="text-lg text-gray-400 mb-6"></p>
            <button id="restart-btn" class="w-full bg-blue-600 text-white font-bold py-3 px-4 rounded-lg hover:bg-blue-700 transition duration-300">
                Volver a Jugar
            </button>
        </div>
    </div>

    <!-- Feedback Popup -->
    <div id="feedback-popup" class="feedback-popup">
        <div id="feedback-text"></div>
        <a id="feedback-link" href="#" target="_blank" class="underline mt-2 inline-block hover:text-blue-300">Consultar Ley</a>
    </div>

<script>
// --- DATABASE ---
const flashcardsDB = [
    // --- DERECHO ADMINISTRATIVO ---
    {
        topic: "administrativo",
        question: "¬øQu√© son los Decretos-leyes seg√∫n el art√≠culo 86 de la Constituci√≥n Espa√±ola?",
        correctAnswer: "Disposiciones normativas con rango de ley que el Gobierno puede dictar en casos de extraordinaria y urgente necesidad.",
        explanation: "Los Decretos-leyes son una fuente directa del derecho administrativo, pero tienen car√°cter provisional y no pueden regular materias reservadas a Ley Org√°nica.",
        distractors: [
            "Leyes org√°nicas aprobadas por el Congreso.",
            "Reglamentos del poder ejecutivo sin rango de ley.",
            "Leyes ordinarias que no requieren urgencia."
        ],
        legalReferenceText: "Art. 86 CE",
        legalReferenceLink: "https://www.boe.es/buscar/act.php?id=BOE-A-1978-31229#a86"
    },
    {
        topic: "administrativo",
        question: "Seg√∫n el art√≠culo 94.1 CE, ¬øqu√© tipo de Tratados requieren la previa autorizaci√≥n de las Cortes Generales?",
        correctAnswer: "Tratados de car√°cter pol√≠tico, militar, que afecten a la integridad territorial o a los derechos fundamentales del T√≠tulo I.",
        explanation: "Esta autorizaci√≥n es crucial porque estos tratados comprometen aspectos soberanos esenciales del Estado, por lo que requieren del m√°ximo consenso parlamentario.",
        distractors: [
            "Todos los tratados internacionales sin excepci√≥n.",
            "√önicamente los tratados de car√°cter econ√≥mico.",
            "Solo los tratados que no impliquen obligaciones financieras."
        ],
        legalReferenceText: "Art. 94.1 CE",
        legalReferenceLink: "https://www.boe.es/buscar/act.php?id=BOE-A-1978-31229#a94"
    },
    {
        topic: "administrativo",
        question: "¬øQu√© significa la inderogabilidad singular de los reglamentos?",
        correctAnswer: "Un √≥rgano administrativo no puede dejar de aplicar un reglamento para un caso concreto mediante una decisi√≥n particular.",
        explanation: "Este principio garantiza la igualdad ante la ley y la seguridad jur√≠dica, impidiendo que la Administraci√≥n act√∫e de forma arbitraria dispensando de la aplicaci√≥n de normas generales.",
        distractors: [
            "Los reglamentos no pueden ser derogados por ninguna ley.",
            "Cualquier reglamento puede ser derogado por una resoluci√≥n administrativa.",
            "Los ciudadanos pueden solicitar no aplicar un reglamento si les perjudica."
        ],
        legalReferenceText: "Art. 37.1 LPAC",
        legalReferenceLink: "https://www.boe.es/buscar/act.php?id=BOE-A-2015-10565#a37"
    },
    {
        topic: "administrativo",
        question: "¬øQu√© es la avocaci√≥n seg√∫n el art√≠culo 10 de la LRJSP?",
        correctAnswer: "Un √≥rgano superior atrae para s√≠ el conocimiento de un asunto cuya resoluci√≥n corresponde a un √≥rgano inferior jer√°rquico.",
        explanation: "La avocaci√≥n es una excepci√≥n al principio de competencia y solo puede realizarse por motivos de eficacia o inter√©s p√∫blico, debidamente justificados.",
        distractors: [
            "La transferencia de la titularidad de la competencia a otro √≥rgano.",
            "La delegaci√≥n de la firma en un √≥rgano inferior.",
            "La asignaci√≥n de tareas materiales a otro √≥rgano por eficacia."
        ],
        legalReferenceText: "Art. 10 LRJSP",
        legalReferenceLink: "https://www.boe.es/buscar/act.php?id=BOE-A-2015-10566#a10"
    },
    {
        topic: "administrativo",
        question: "¬øCu√°l es una diferencia clave entre un Organismo Aut√≥nomo y una Entidad P√∫blica Empresarial?",
        correctAnswer: "Los Organismos Aut√≥nomos se rigen principalmente por derecho p√∫blico, mientras que las Entidades P√∫blicas Empresariales se rigen en gran medida por derecho privado.",
        explanation: "Esta diferencia en el r√©gimen jur√≠dico afecta a su personal, contrataci√≥n y gesti√≥n patrimonial, dando m√°s flexibilidad a las Entidades P√∫blicas Empresariales para operar en el mercado.",
        distractors: [
            "Los Organismos Aut√≥nomos tienen √°nimo de lucro y las Entidades P√∫blicas no.",
            "Solo las Entidades P√∫blicas Empresariales tienen personalidad jur√≠dica propia.",
            "Los Organismos Aut√≥nomos no pueden prestar servicios, solo realizar investigaci√≥n."
        ],
        legalReferenceText: "Arts. 88 y 103 LRJSP",
        legalReferenceLink: "https://www.boe.es/buscar/act.php?id=BOE-A-2015-10566#a88"
    },
    {
        topic: "administrativo",
        question: "Seg√∫n el art√≠culo 14.2 de la LPAC, ¬øqui√©nes est√°n obligados a relacionarse electr√≥nicamente con las AAPP?",
        correctAnswer: "Las personas jur√≠dicas, quienes ejerzan una actividad profesional con colegiaci√≥n obligatoria y quienes les representen.",
        explanation: "La ley busca modernizar la Administraci√≥n, estableciendo esta obligaci√≥n para colectivos con mayor capacidad t√©cnica y econ√≥mica, mientras que para las personas f√≠sicas es un derecho.",
        distractors: [
            "Todas las personas f√≠sicas sin excepci√≥n.",
            "√önicamente las grandes empresas con m√°s de 50 empleados.",
            "Solo las personas que voluntariamente elijan ese medio."
        ],
        legalReferenceText: "Art. 14.2 LPAC",
        legalReferenceLink: "https://www.boe.es/buscar/act.php?id=BOE-A-2015-10565#a14"
    },
     {
        topic: "administrativo",
        question: "¬øQu√© efecto general tiene el silencio administrativo en procedimientos iniciados a solicitud del interesado?",
        correctAnswer: "Estimatorio (positivo), salvo que una norma con rango de Ley o de Derecho de la UE establezca lo contrario.",
        explanation: "Es una garant√≠a para el ciudadano frente a la inactividad de la Administraci√≥n. Si la Administraci√≥n no resuelve en plazo, el ciudadano puede entender que su solicitud ha sido aceptada.",
        distractors: [
            "Siempre desestimatorio (negativo).",
            "Siempre produce la caducidad del procedimiento.",
            "Depende de la decisi√≥n posterior del √≥rgano administrativo."
        ],
        legalReferenceText: "Art. 24 LPAC",
        legalReferenceLink: "https://www.boe.es/buscar/act.php?id=BOE-A-2015-10565#a24"
    },
    {
        topic: "administrativo",
        question: "¬øQu√© es un acto nulo de pleno derecho seg√∫n el art√≠culo 47 de la LPAC?",
        correctAnswer: "Un acto que lesiona derechos fundamentales, dictado por √≥rgano manifiestamente incompetente o con contenido imposible, entre otros.",
        explanation: "La nulidad es la m√°xima sanci√≥n de invalidez de un acto administrativo. Sus efectos son retroactivos (ex tunc) y la acci√≥n para declararla no prescribe.",
        distractors: [
            "Un acto que contiene un simple error material que puede ser corregido.",
            "Cualquier acto que sea desfavorable para el ciudadano.",
            "Un acto que no ha sido notificado en el plazo de 10 d√≠as."
        ],
        legalReferenceText: "Art. 47 LPAC",
        legalReferenceLink: "https://www.boe.es/buscar/act.php?id=BOE-A-2015-10565#a47"
    },
    {
        topic: "administrativo",
        question: "¬øC√≥mo se computan los plazos por d√≠as seg√∫n la LPAC?",
        correctAnswer: "Se entienden que son d√≠as h√°biles, excluyendo s√°bados, domingos y festivos.",
        explanation: "Esta regla es fundamental para calcular correctamente los plazos para presentar recursos o realizar tr√°mites. Solo si una norma lo indica expresamente, los d√≠as ser√°n naturales.",
        distractors: [
            "Siempre son d√≠as naturales, incluyendo festivos.",
            "Son d√≠as h√°biles, excluyendo √∫nicamente los domingos.",
            "Son 15 d√≠as naturales si la ley no dice nada."
        ],
        legalReferenceText: "Art. 30 LPAC",
        legalReferenceLink: "https://www.boe.es/buscar/act.php?id=BOE-A-2015-10565#a30"
    },
    {
        topic: "administrativo",
        question: "¬øQu√© es la caducidad en un procedimiento iniciado a instancia de parte?",
        correctAnswer: "La finalizaci√≥n del procedimiento por inactividad del interesado durante los plazos establecidos, previa advertencia de la Administraci√≥n.",
        explanation: "La caducidad se produce cuando la paralizaci√≥n del procedimiento es imputable al interesado, y la Administraci√≥n debe notificarle que, de no actuar, se archivar√° el expediente.",
        distractors: [
            "La anulaci√≥n del procedimiento por parte de la Administraci√≥n por falta de pruebas.",
            "El desistimiento voluntario del interesado.",
            "La prescripci√≥n de la acci√≥n para iniciar el procedimiento."
        ],
        legalReferenceText: "Art. 95 LPAC",
        legalReferenceLink: "https://www.boe.es/buscar/act.php?id=BOE-A-2015-10565#a95"
    },
    {
        topic: "administrativo",
        question: "¬øContra qu√© actos procede el Recurso de Alzada?",
        correctAnswer: "Contra resoluciones y actos de tr√°mite que no pongan fin a la v√≠a administrativa.",
        explanation: "Es un recurso jer√°rquico que permite que el √≥rgano superior revise la decisi√≥n del √≥rgano inferior, siempre que el acto no sea definitivo en v√≠a administrativa.",
        distractors: [
            "Contra actos que pongan fin a la v√≠a administrativa.",
            "Contra disposiciones administrativas de car√°cter general (reglamentos).",
            "√önicamente contra sentencias judiciales firmes."
        ],
        legalReferenceText: "Art. 121 LPAC",
        legalReferenceLink: "https://www.boe.es/buscar/act.php?id=BOE-A-2015-10565#a121"
    },
    {
        topic: "administrativo",
        question: "Seg√∫n la LCSP, ¬øqu√© es el 'valor estimado' de un contrato?",
        correctAnswer: "La cuant√≠a total de las prestaciones, incluyendo pr√≥rrogas y opciones, IVA excluido, para determinar el procedimiento de adjudicaci√≥n.",
        explanation: "El valor estimado es clave para determinar si un contrato est√° sujeto a regulaci√≥n armonizada (SARA) y qu√© umbrales de publicidad y procedimiento se deben aplicar, garantizando la concurrencia.",
        distractors: [
            "El precio final que se paga al adjudicatario con IVA incluido.",
            "La oferta econ√≥mica m√°s baja presentada en la licitaci√≥n.",
            "El presupuesto m√°ximo que la Administraci√≥n puede gastar."
        ],
        legalReferenceText: "Art. 101 LCSP",
        legalReferenceLink: "https://www.boe.es/buscar/act.php?id=BOE-A-2017-12902#a101"
    },
    {
        topic: "administrativo",
        question: "¬øQu√© principio rige la responsabilidad patrimonial de la Administraci√≥n seg√∫n el art. 106.2 CE?",
        correctAnswer: "Los particulares ser√°n indemnizados por toda lesi√≥n en sus bienes y derechos, salvo fuerza mayor, derivada del funcionamiento normal o anormal de los servicios p√∫blicos.",
        explanation: "Es un sistema de responsabilidad objetiva; no se necesita demostrar culpa de la Administraci√≥n, solo la existencia de un da√±o y una relaci√≥n de causalidad con el servicio p√∫blico.",
        distractors: [
            "La Administraci√≥n solo responde si act√∫a con dolo o culpa grave.",
            "La Administraci√≥n nunca responde por el funcionamiento normal de sus servicios.",
            "Los particulares deben demostrar siempre que la Administraci√≥n cometi√≥ una ilegalidad."
        ],
        legalReferenceText: "Art. 106.2 CE",
        legalReferenceLink: "https://www.boe.es/buscar/act.php?id=BOE-A-1978-31229#a106"
    },
    {
        topic: "administrativo",
        question: "¬øQu√© es un bien de dominio p√∫blico o demanial?",
        correctAnswer: "Aquel que, siendo de titularidad p√∫blica, est√° afectado al uso general o al servicio p√∫blico.",
        explanation: "Estos bienes (como costas, r√≠os, carreteras) tienen un r√©gimen de protecci√≥n especial: son inalienables, imprescriptibles e inembargables para garantizar su finalidad p√∫blica.",
        distractors: [
            "Cualquier bien propiedad de una Administraci√≥n P√∫blica.",
            "Los bienes que la Administraci√≥n puede vender libremente en el mercado.",
            "Los bienes embargados por la Hacienda P√∫blica."
        ],
        legalReferenceText: "Art. 5 Ley 33/2003",
        legalReferenceLink: "https://www.boe.es/buscar/act.php?id=BOE-A-2003-20254#a5"
    },
    {
        topic: "administrativo",
        question: "¬øCu√°l es una de las causas de p√©rdida de la condici√≥n de funcionario de carrera seg√∫n el EBEP?",
        correctAnswer: "La renuncia, la p√©rdida de la nacionalidad, la jubilaci√≥n, la sanci√≥n disciplinaria de separaci√≥n del servicio o la pena de inhabilitaci√≥n absoluta.",
        explanation: "El EBEP establece un listado cerrado de causas que extinguen de forma definitiva la relaci√≥n de servicio del funcionario con la Administraci√≥n.",
        distractors: [
            "Solicitar una excedencia voluntaria por inter√©s particular.",
            "Obtener una mala calificaci√≥n en la evaluaci√≥n de desempe√±o.",
            "Cambiar de destino a otra Administraci√≥n P√∫blica."
        ],
        legalReferenceText: "Art. 63 TREBEP",
        legalReferenceLink: "https://www.boe.es/buscar/act.php?id=BOE-A-2015-11719#a63"
    },
    
    // --- DERECHO CIVIL ---
    {
        topic: "civil",
        question: "¬øCu√°les son las fuentes del derecho seg√∫n el art√≠culo 1.1 del C√≥digo Civil?",
        correctAnswer: "La ley, la costumbre y los principios generales del derecho.",
        explanation: "El C√≥digo Civil establece una jerarqu√≠a de fuentes. La costumbre solo rige en defecto de ley aplicable, y los principios generales en defecto de ley o costumbre.",
        distractors: [
            "Solo la ley y la jurisprudencia.",
            "La ley, los decretos y las √≥rdenes ministeriales.",
            "La Constituci√≥n, la ley y los tratados internacionales."
        ],
        legalReferenceText: "Art. 1.1 CC",
        legalReferenceLink: "https://www.boe.es/buscar/act.php?id=BOE-A-1889-4763#art1"
    },
    {
        topic: "civil",
        question: "¬øCu√°ndo se adquiere la personalidad civil seg√∫n el C√≥digo Civil?",
        correctAnswer: "Con el nacimiento, una vez producido el entero desprendimiento del seno materno.",
        explanation: "La personalidad determina la aptitud para ser titular de derechos y obligaciones. El C√≥digo Civil protege tambi√©n al concebido pero no nacido (nasciturus) para los efectos que le sean favorables.",
        distractors: [
            "En el momento de la concepci√≥n.",
            "Al cumplir la mayor√≠a de edad.",
            "Al ser inscrito en el Registro Civil."
        ],
        legalReferenceText: "Art. 30 CC",
        legalReferenceLink: "https://www.boe.es/buscar/act.php?id=BOE-A-1889-4763#art30"
    },
    {
        topic: "civil",
        question: "En el r√©gimen de sociedad de gananciales, ¬øqu√© car√°cter tienen los frutos o rentas de los bienes privativos?",
        correctAnswer: "Son bienes gananciales.",
        explanation: "Aunque el bien que los produce sea privativo de un c√≥nyuge (ej. un piso heredado), las rentas que genera (ej. el alquiler) se integran en el patrimonio com√∫n del matrimonio.",
        distractors: [
            "Son siempre bienes privativos.",
            "Se dividen por la mitad entre privativos y gananciales.",
            "Pertenecen al c√≥nyuge que sea titular del bien privativo."
        ],
        legalReferenceText: "Art. 1347 CC",
        legalReferenceLink: "https://www.boe.es/buscar/act.php?id=BOE-A-1889-4763#art1347"
    },
    {
        topic: "civil",
        question: "Diferencia entre prescripci√≥n y caducidad.",
        correctAnswer: "La prescripci√≥n extingue la acci√≥n pero no el derecho y puede interrumpirse, mientras que la caducidad extingue el derecho y no se puede interrumpir.",
        explanation: "La prescripci√≥n se basa en la inactividad del titular y puede ser interrumpida por reclamaci√≥n. La caducidad opera autom√°ticamente por el mero paso del tiempo fijado por la ley.",
        distractors: [
            "No hay ninguna diferencia, son t√©rminos sin√≥nimos.",
            "La prescripci√≥n solo se aplica a derechos reales y la caducidad a derechos personales.",
            "La caducidad puede ser interrumpida por reclamaci√≥n judicial, pero la prescripci√≥n no."
        ],
        legalReferenceText: "Arts. 1961 y ss. CC",
        legalReferenceLink: "https://www.boe.es/buscar/act.php?id=BOE-A-1889-4763#art1961"
    },
    {
        topic: "civil",
        question: "¬øQu√© es un derecho real de hipoteca?",
        correctAnswer: "Un derecho de garant√≠a que recae sobre un bien inmueble para asegurar el cumplimiento de una obligaci√≥n, sin desplazamiento de la posesi√≥n.",
        explanation: "Permite al acreedor, en caso de impago, solicitar la venta del inmueble en p√∫blica subasta para cobrar su cr√©dito con el dinero obtenido, con preferencia sobre otros acreedores.",
        distractors: [
            "Un derecho a usar y disfrutar un bien ajeno.",
            "Un contrato de alquiler con opci√≥n a compra.",
            "Un derecho de garant√≠a sobre un bien mueble con entrega de la posesi√≥n."
        ],
        legalReferenceText: "Art. 1876 CC",
        legalReferenceLink: "https://www.boe.es/buscar/act.php?id=BOE-A-1889-4763#art1876"
    },
    {
        topic: "civil",
        question: "Para que una donaci√≥n de un bien inmueble sea v√°lida, ¬øqu√© requisito de forma exige el C√≥digo Civil?",
        correctAnswer: "Debe hacerse en escritura p√∫blica.",
        explanation: "Es un requisito 'ad solemnitatem', es decir, su incumplimiento provoca la nulidad absoluta de la donaci√≥n. No basta un documento privado.",
        distractors: [
            "Es suficiente un contrato privado.",
            "Puede hacerse verbalmente si hay testigos.",
            "Requiere inscripci√≥n obligatoria en el Registro de la Propiedad para ser v√°lida."
        ],
        legalReferenceText: "Art. 633 CC",
        legalReferenceLink: "https://www.boe.es/buscar/act.php?id=BOE-A-1889-4763#art633"
    },
    {
        topic: "civil",
        question: "Seg√∫n el CC, la posesi√≥n de un bien inmueble presume la posesi√≥n de...",
        correctAnswer: "Los bienes muebles que se hallen dentro de √©l, mientras no conste o se acredite que deben ser excluidos.",
        explanation: "Esta presunci√≥n 'iuris tantum' (admite prueba en contrario) facilita las relaciones jur√≠dicas, asumiendo que quien posee el continente, posee tambi√©n el contenido.",
        distractors: [
            "√önicamente el suelo, no lo que hay en su interior.",
            "Otros inmuebles colindantes.",
            "Los derechos de autor sobre las obras creadas en √©l."
        ],
        legalReferenceText: "Art. 449 CC",
        legalReferenceLink: "https://www.boe.es/buscar/act.php?id=BOE-A-1889-4763#art449"
    },
    {
        topic: "civil",
        question: "¬øQu√© es el principio de fe p√∫blica registral?",
        correctAnswer: "Protege al tercero que adquiere de buena fe y a t√≠tulo oneroso un derecho de quien aparece con facultades para transmitirlo en el Registro de la Propiedad.",
        explanation: "Este principio es la piedra angular de la seguridad jur√≠dica inmobiliaria. Lo que publica el Registro se presume exacto, protegiendo a quien conf√≠a en dicha publicidad.",
        distractors: [
            "Obliga a que todos los documentos privados se eleven a p√∫blicos.",
            "Significa que todo lo que dice un notario es cierto sin prueba en contrario.",
            "Presume que todos los bienes inmuebles est√°n inscritos en el Registro."
        ],
        legalReferenceText: "Art. 34 Ley Hipotecaria",
        legalReferenceLink: "https://www.boe.es/buscar/act.php?id=BOE-A-1946-2453#a34"
    },
    {
        topic: "civil",
        question: "¬øCu√°l es la principal diferencia entre las obligaciones mancomunadas y las solidarias?",
        correctAnswer: "En las mancomunadas cada deudor debe solo su parte, en las solidarias cualquiera puede ser reclamado por el total.",
        explanation: "La solidaridad es una garant√≠a m√°s fuerte para el acreedor, ya que puede dirigirse contra el deudor m√°s solvente por la totalidad de la deuda. La solidaridad no se presume, debe pactarse.",
        distractors: [
            "Las mancomunadas solo aplican a deudas de dinero y las solidarias a obligaciones de hacer.",
            "Las solidarias requieren pacto expreso, las mancomunadas son la regla general.",
            "Las mancomunadas no admiten varios acreedores, las solidarias s√≠."
        ],
        legalReferenceText: "Art. 1137 CC",
        legalReferenceLink: "https://www.boe.es/buscar/act.php?id=BOE-A-1889-4763#art1137"
    },
    {
        topic: "civil",
        question: "Causa de nulidad de un contrato",
        correctAnswer: "La falta de uno de sus elementos esenciales: consentimiento, objeto o causa.",
        explanation: "Un contrato sin alguno de estos tres pilares es nulo de pleno derecho, lo que significa que no produce ning√∫n efecto jur√≠dico desde su celebraci√≥n.",
        distractors: [
            "Que una de las partes se arrepienta despu√©s de firmar.",
            "El incumplimiento de una de las cl√°usulas.",
            "Que el contrato sea perjudicial para una de las partes (lesi√≥n)."
        ],
        legalReferenceText: "Art. 1261 CC",
        legalReferenceLink: "https://www.boe.es/buscar/act.php?id=BOE-A-1889-4763#art1261"
    },
    
    // --- DERECHO MERCANTIL ---
    {
        topic: "mercantil",
        question: "¬øCu√°les son las fuentes del Derecho Mercantil seg√∫n el C√≥digo de Comercio?",
        correctAnswer: "El C√≥digo de Comercio, los usos del comercio y, en su defecto, el Derecho com√∫n (civil).",
        explanation: "A diferencia del Derecho Civil, en el Mercantil los 'usos de comercio' (costumbres mercantiles) tienen una gran importancia como fuente del derecho, aplic√°ndose antes que el derecho com√∫n.",
        distractors: [
            "√önicamente el C√≥digo de Comercio.",
            "La ley mercantil, la costumbre civil y los principios generales del derecho.",
            "Los tratados internacionales y la jurisprudencia del Tribunal Supremo."
        ],
        legalReferenceText: "Art. 2 CCo",
        legalReferenceLink: "https://www.boe.es/buscar/act.php?id=BOE-A-1885-6627#a2"
    },
    {
        topic: "mercantil",
        question: "¬øQui√©nes son considerados comerciantes para el C√≥digo de Comercio?",
        correctAnswer: "Los que, teniendo capacidad legal para ejercer el comercio, se dedican a √©l habitualmente, y las compa√±√≠as mercantiles o industriales.",
        explanation: "La clave es la habitualidad en el ejercicio del comercio para las personas f√≠sicas. Las sociedades mercantiles lo son por su propia forma, independientemente de su actividad.",
        distractors: [
            "Cualquier persona que realice una compra para revender.",
            "Solo las personas jur√≠dicas inscritas en el Registro Mercantil.",
            "Los artesanos y agricultores."
        ],
        legalReferenceText: "Art. 1 CCo",
        legalReferenceLink: "https://www.boe.es/buscar/act.php?id=BOE-A-1885-6627#a1"
    },
    {
        topic: "mercantil",
        question: "Diferencia principal entre marca y nombre comercial.",
        correctAnswer: "La marca distingue productos o servicios en el mercado, mientras que el nombre comercial identifica a una empresa en el tr√°fico mercantil.",
        explanation: "Una misma empresa (protegida por su nombre comercial) puede tener m√∫ltiples marcas para sus diferentes l√≠neas de productos o servicios.",
        distractors: [
            "La marca se registra en la OEPM y el nombre comercial no.",
            "El nombre comercial tiene protecci√≥n internacional autom√°tica y la marca no.",
            "Son sin√≥nimos y se pueden usar indistintamente."
        ],
        legalReferenceText: "Ley 17/2001 de Marcas",
        legalReferenceLink: "https://www.boe.es/buscar/act.php?id=BOE-A-2001-23093"
    },
    {
        topic: "mercantil",
        question: "¬øQu√© libros contables son obligatorios para todo empresario seg√∫n el C√≥digo de Comercio?",
        correctAnswer: "Un libro de Inventarios y Cuentas Anuales y otro Diario.",
        explanation: "El libro Diario registra las operaciones d√≠a a d√≠a, y el de Inventarios y Cuentas Anuales recoge el balance inicial y los balances trimestrales de comprobaci√≥n, as√≠ como las cuentas anuales al cierre.",
        distractors: [
            "Solo el libro de facturas emitidas y recibidas.",
            "El libro de actas, el libro de socios y el libro diario.",
            "Ninguno es obligatorio, solo recomendable."
        ],
        legalReferenceText: "Art. 25 CCo",
        legalReferenceLink: "https://www.boe.es/buscar/act.php?id=BOE-A-1885-6627#a25"
    },
    {
        topic: "mercantil",
        question: "Diferencia fundamental en la responsabilidad de los socios en una Sociedad Colectiva y una Sociedad de Responsabilidad Limitada.",
        correctAnswer: "En la Colectiva los socios responden de forma personal, ilimitada y solidaria; en la Limitada, la responsabilidad se limita al capital aportado.",
        explanation: "La SRL protege el patrimonio personal de los socios, siendo este el motivo principal de su popularidad. En la Colectiva, los acreedores pueden ir contra los bienes personales de los socios.",
        distractors: [
            "En la Limitada todos los socios son administradores, en la Colectiva no.",
            "La Colectiva no requiere capital m√≠nimo, la Limitada s√≠.",
            "En la Colectiva los socios no pueden trabajar en la empresa, en la Limitada s√≠."
        ],
        legalReferenceText: "Art. 127 CCo y TRLSC",
        legalReferenceLink: "https://www.boe.es/buscar/act.php?id=BOE-A-1885-6627#a127"
    },
    {
        topic: "mercantil",
        question: "¬øCu√°l es el capital social m√≠nimo para constituir una Sociedad An√≥nima (SA)?",
        correctAnswer: "60.000 euros.",
        explanation: "Esta cifra, superior a la de la SRL, refleja que la SA est√° pensada para proyectos empresariales de mayor envergadura y con posibilidad de cotizar en bolsa.",
        distractors: [
            "3.000 euros.",
            "No hay capital m√≠nimo.",
            "120.000 euros."
        ],
        legalReferenceText: "Art. 4 TRLSC",
        legalReferenceLink: "https://www.boe.es/buscar/act.php?id=BOE-A-2010-10544#a4"
    },
    {
        topic: "mercantil",
        question: "En una Sociedad An√≥nima (SA), ¬øa qui√©n corresponde la competencia para modificar los estatutos sociales?",
        correctAnswer: "A la Junta General de Accionistas.",
        explanation: "La modificaci√≥n de los estatutos es una decisi√≥n de m√°xima trascendencia para la sociedad, por lo que la ley reserva esta competencia al √≥rgano soberano de la misma: la Junta General.",
        distractors: [
            "Al Consejo de Administraci√≥n.",
            "Al administrador √∫nico.",
            "Al Registrador Mercantil."
        ],
        legalReferenceText: "Art. 160 TRLSC",
        legalReferenceLink: "https://www.boe.es/buscar/act.php?id=BOE-A-2010-10544#a160"
    },
    {
        topic: "mercantil",
        question: "Requisito esencial que debe contener una letra de cambio para ser v√°lida.",
        correctAnswer: "La denominaci√≥n 'letra de cambio' inserta en el propio texto del t√≠tulo.",
        explanation: "Este requisito de literalidad es fundamental para la seguridad del tr√°fico jur√≠dico, asegurando que todas las partes saben que est√°n ante un t√≠tulo con las rigurosas consecuencias de la acci√≥n cambiaria.",
        distractors: [
            "El NIF del librado.",
            "La firma de dos testigos.",
            "Estar emitida en papel timbrado oficial."
        ],
        legalReferenceText: "Art. 1 Ley Cambiaria",
        legalReferenceLink: "https://www.boe.es/buscar/act.php?id=BOE-A-1985-15264#a1"
    },
    {
        topic: "mercantil",
        question: "En el contrato de compraventa mercantil, ¬øcu√°ndo se transfiere el riesgo de p√©rdida de la cosa al comprador?",
        correctAnswer: "Generalmente, desde la puesta a disposici√≥n de la mercanc√≠a, incluso antes de la entrega f√≠sica.",
        explanation: "A diferencia del r√©gimen civil, en el mercantil el riesgo se transmite con la 'puesta a disposici√≥n', lo que significa que si el comprador se retrasa en recogerla, asume el riesgo desde ese momento.",
        distractors: [
            "Solo en el momento de la entrega f√≠sica de la mercanc√≠a.",
            "Desde el momento en que se firma el contrato.",
            "Nunca se transfiere el riesgo, siempre es del vendedor."
        ],
        legalReferenceText: "Art. 333 CCo",
        legalReferenceLink: "https://www.boe.es/buscar/act.php?id=BOE-A-1885-6627#a333"
    },
    {
        topic: "mercantil",
        question: "¬øQu√© es el concurso de acreedores?",
        correctAnswer: "Un procedimiento judicial que se inicia cuando una persona o empresa se encuentra en estado de insolvencia y no puede cumplir regularmente sus obligaciones.",
        explanation: "Su finalidad es buscar una soluci√≥n ordenada a la situaci√≥n de insolvencia, ya sea a trav√©s de un convenio con los acreedores o mediante la liquidaci√≥n del patrimonio del deudor para pagar las deudas.",
        distractors: [
            "Un acuerdo privado entre un deudor y sus acreedores para aplazar pagos.",
            "Una subasta p√∫blica de los bienes de una empresa.",
            "Un tipo de sociedad mercantil para situaciones de crisis."
        ],
        legalReferenceText: "TR Ley Concursal",
        legalReferenceLink: "https://www.boe.es/buscar/act.php?id=BOE-A-2020-4859"
    }
];

// --- APPLICATION LOGIC ---
const setupScreen = document.getElementById('setup-screen');
const quizScreen = document.getElementById('quiz-screen');
const resultsScreen = document.getElementById('results-screen');

const startBtn = document.getElementById('start-btn');
const restartBtn = document.getElementById('restart-btn');
const topicSelect = document.getElementById('topic');
const numQuestionsEl = document.getElementById('num-questions');

const questionEl = document.getElementById('question');
const optionsEl = document.getElementById('options');
const progressEl = document.getElementById('progress');
const scoreDisplayEl = document.getElementById('score-display');
const motivationalPhraseEl = document.getElementById('motivational-phrase');

const resultsSummaryEl = document.getElementById('results-summary');
const reviewListEl = document.getElementById('review-list');
const finalMessageEl = document.getElementById('final-message');

const feedbackPopup = document.getElementById('feedback-popup');
const feedbackText = document.getElementById('feedback-text');
const feedbackLink = document.getElementById('feedback-link');

let currentQuiz = [];
let currentQuestionIndex = 0;
let score = { correct: 0, incorrect: 0 };
let incorrectAnswers = [];

const motivationalPhrases = [
    "Cada pregunta es un paso m√°s hacia tu meta. ¬°Sigue as√≠!",
    "La constancia es la clave del √©xito. ¬°No te rindas!",
    "El esfuerzo de hoy es la recompensa de ma√±ana.",
    "Est√°s construyendo un futuro brillante. ¬°√Ånimo!",
    "Conf√≠a en tu preparaci√≥n. ¬°Puedes con esto!"
];

const finalMessages = {
    good: "¬°Excelente trabajo! Tu dedicaci√≥n est√° dando frutos. Sigue repasando y consolidando tus conocimientos.",
    medium: "¬°Buen esfuerzo! Vas por el buen camino. Conc√©ntrate en las √°reas de repaso y ver√°s c√≥mo mejoras.",
    bad: "¬°No te desanimes! Cada intento es una oportunidad de aprendizaje. Revisa los conceptos y vuelve a intentarlo con m√°s fuerza."
};


function shuffleArray(array) {
    for (let i = array.length - 1; i > 0; i--) {
        const j = Math.floor(Math.random() * (i + 1));
        [array[i], array[j]] = [array[j], array[i]];
    }
    return array;
}

function startGame() {
    const selectedTopic = topicSelect.value;
    let numQuestions = parseInt(numQuestionsEl.value, 10);

    let filteredFlashcards = flashcardsDB;
    if (selectedTopic !== 'todo') {
        filteredFlashcards = flashcardsDB.filter(card => card.topic === selectedTopic);
    }
    
    if (isNaN(numQuestions) || numQuestions < 1) {
        numQuestions = 1;
        numQuestionsEl.value = 1;
    }
    if (numQuestions > filteredFlashcards.length) {
        numQuestions = filteredFlashcards.length;
        numQuestionsEl.value = numQuestions;
    }


    currentQuiz = shuffleArray([...filteredFlashcards]).slice(0, numQuestions);
    currentQuestionIndex = 0;
    score = { correct: 0, incorrect: 0 };
    incorrectAnswers = [];

    updateScoreDisplay();
    setupScreen.classList.add('hidden');
    resultsScreen.classList.add('hidden');
    quizScreen.classList.remove('hidden');
    
    displayQuestion();
}

function displayQuestion() {
    if (currentQuestionIndex >= currentQuiz.length) {
        showResults();
        return;
    }

    const card = currentQuiz[currentQuestionIndex];
    progressEl.textContent = `Pregunta ${currentQuestionIndex + 1} de ${currentQuiz.length}`;
    questionEl.innerHTML = card.question; 

    optionsEl.innerHTML = '';
    const options = shuffleArray([card.correctAnswer, ...card.distractors]);
    
    options.forEach(option => {
        const button = document.createElement('button');
        button.className = 'btn text-white';
        button.innerHTML = option;
        button.addEventListener('click', () => checkAnswer(option, card, button));
        optionsEl.appendChild(button);
    });
    
    motivationalPhraseEl.textContent = motivationalPhrases[Math.floor(Math.random() * motivationalPhrases.length)];
}

function checkAnswer(selectedOption, card, button) {
    const buttons = optionsEl.querySelectorAll('button');
    buttons.forEach(btn => btn.disabled = true);

    const isCorrect = selectedOption === card.correctAnswer;
    
    if (isCorrect) {
        score.correct++;
        button.classList.add('btn-correct');
        showFeedbackPopup(true, card);
    } else {
        score.incorrect++;
        button.classList.add('btn-incorrect');
        incorrectAnswers.push(card);
        buttons.forEach(btn => {
            if (btn.innerHTML === card.correctAnswer) {
                btn.classList.add('btn-correct');
            }
        });
        showFeedbackPopup(false, card);
    }

    updateScoreDisplay();
    
    setTimeout(() => {
        currentQuestionIndex++;
        displayQuestion();
    }, 4000); // Increased timeout for reading the explanation
}

function showFeedbackPopup(isCorrect, card) {
    if (isCorrect) {
        feedbackText.innerHTML = '¬°Correcto! üéâ';
        feedbackPopup.style.backgroundColor = '#10b981';
    } else {
        feedbackText.innerHTML = `Incorrecto. üí™<br><strong class="font-normal">La respuesta correcta es:</strong><br><span class="font-normal text-base">${card.correctAnswer}</span><br><em class="text-sm font-normal text-gray-300">${card.explanation}</em>`;
        feedbackPopup.style.backgroundColor = '#ef4444';
    }
    
    feedbackLink.href = card.legalReferenceLink;
    feedbackLink.textContent = `Consultar ${card.legalReferenceText}`;

    feedbackPopup.classList.add('show');
    
    setTimeout(() => {
        feedbackPopup.classList.remove('show');
    }, 3900); // Slightly less than the question timer
}

function updateScoreDisplay() {
    scoreDisplayEl.innerHTML = `‚úÖ ${score.correct} <span class="mx-2">|</span> ‚ùå ${score.incorrect}`;
}

function showResults() {
    quizScreen.classList.add('hidden');
    resultsScreen.classList.remove('hidden');

    const total = currentQuiz.length;
    const correct = score.correct;
    const percentage = total > 0 ? ((correct / total) * 100).toFixed(0) : 0;

    resultsSummaryEl.innerHTML = `Has acertado <span class="font-bold text-green-400">${correct}</span> de <span class="font-bold">${total}</span> preguntas. (${percentage}%)`;

    reviewListEl.innerHTML = '';
    if (incorrectAnswers.length > 0) {
        reviewListEl.parentElement.style.display = 'block';
        incorrectAnswers.forEach(card => {
            const li = document.createElement('li');
            li.innerHTML = `<span class="font-semibold">${card.question}</span><br><span class="text-sm text-gray-400">Respuesta correcta: ${card.correctAnswer}</span>`;
            reviewListEl.appendChild(li);
        });
    } else {
        reviewListEl.parentElement.style.display = 'none';
        reviewListEl.innerHTML = '<p>¬°Felicidades! No has cometido ning√∫n error. üéâ</p>';
    }

    if (percentage >= 80) {
        finalMessageEl.textContent = finalMessages.good;
    } else if (percentage >= 50) {
        finalMessageEl.textContent = finalMessages.medium;
    } else {
        finalMessageEl.textContent = finalMessages.bad;
    }
}

function restartGame() {
    resultsScreen.classList.add('hidden');
    setupScreen.classList.remove('hidden');
}

function updateMaxQuestions() {
    const selectedTopic = topicSelect.value;
    let maxQuestions = flashcardsDB.length;
    if (selectedTopic !== 'todo') {
        maxQuestions = flashcardsDB.filter(card => card.topic === selectedTopic).length;
    }
    numQuestionsEl.max = maxQuestions;
    if (parseInt(numQuestionsEl.value) > maxQuestions) {
        numQuestionsEl.value = maxQuestions;
    }
}

// Event Listeners
startBtn.addEventListener('click', startGame);
restartBtn.addEventListener('click', restartGame);
topicSelect.addEventListener('change', updateMaxQuestions);

// Initial setup
updateMaxQuestions();

</script>
</body>
</html>
